#/projects/AusGEM/Users/Max/Manuscripts/Salmonella_EB_2022/analysis/pairwise_snps/Typhimurium/HC2_1852/LT2_snp
#for f in LT2*/snps.tab; do echo ${f/\/snps.tab} $(grep "4273272" $f); done > temp && grep "NC" temp | cut -d" " -f1 > genomes_with_4273272_mutation.txt

#Change SNP coordinate above accordingly as per https://bmcmicrobiol.biomedcentral.com/articles/10.1186/s12866-016-0831-3/figures/2
#Coordinates are not exact - we used NC_003197.2 they used NC_003197.1

#genomes_with_2332556_Deletion.txt
metadata %>% filter(HC2 == 1852) %>% select(Name, ID, outbreak) %>%
        filter(ID %in% c("SRR3476817",
                           "SRR3476818",
                           "SRR3476819",
                           "SRR3476820",
                           "SRR3476821",
                           "SRR3476823",
                           "SRR3476824",
                           "SRR3476825",
                           "SRR3476826",
                           "SRR3476827",
                           "SRR3476828",
                           "SRR3476829",
                           "SRR3476832",
                           "SRR3476837",
                           "SRR3476838",
                           "SRR3476839",
                           "SRR3476840",
                           "SRR3476841",
                           "SRR3476842",
                           "SRR3476843",
                           "SRR3476845",
                           "SRR3476846",
                           "SRR4419666",
                           "SRR4419679")) %>% View()

#genomes_with_3491782_mutation.txt
metadata %>% filter(HC2 == 1852) %>% select(Name, ID, outbreak) %>%
        filter(ID %in% c("SRR3476788",
                        "SRR3476789",
                        "SRR3476790",
                        "SRR3476791",
                        "SRR3476792",
                        "SRR3476793",
                        "SRR3476794",
                        "SRR3476795",
                        "SRR3476796",
                        "SRR3476797",
                        "SRR3476798",
                        "SRR3476799",
                        "SRR3476801",
                        "SRR3476802",
                        "SRR3476803",
                        "SRR3476804",
                        "SRR3476805",
                        "SRR3476806",
                        "SRR3476808",
                        "SRR3476809",
                        "SRR3476810",
                        "SRR3476812",
                        "SRR3476814",
                        "SRR3476817",
                        "SRR3476818",
                        "SRR3476819",
                        "SRR3476820",
                        "SRR3476821",
                        "SRR3476822",
                        "SRR3476823",
                        "SRR3476824",
                        "SRR3476825",
                        "SRR3476826",
                        "SRR3476827",
                        "SRR3476828",
                        "SRR3476829",
                        "SRR3476833",
                        "SRR3476835",
                        "SRR3476836",
                        "SRR3476837",
                        "SRR3476838",
                        "SRR3476839",
                        "SRR3476840",
                        "SRR3476841",
                        "SRR3476842",
                        "SRR3476843",
                        "SRR3476844",
                        "SRR3476845",
                        "SRR3476847",
                        "SRR3476848",
                        "SRR3476849",
                        "SRR4419674",
                        "SRR4419679")) %>% View()

#genomes_with_4273272_mutation.txt
metadata %>% filter(HC2 == 1852) %>% select(Name, ID, outbreak) %>%
        filter(ID %in% c("SRR3476788",
"SRR3476789",
"SRR3476790",
"SRR3476791",
"SRR3476792",
"SRR3476793",
"SRR3476794",
"SRR3476795",
"SRR3476796",
"SRR3476797",
"SRR3476798",
"SRR3476799",
"SRR3476801",
"SRR3476802",
"SRR3476803",
"SRR3476804",
"SRR3476805",
"SRR3476806",
"SRR3476808",
"SRR3476809",
"SRR3476810",
"SRR3476812",
"SRR3476814",
"SRR3476817",
"SRR3476818",
"SRR3476819",
"SRR3476820",
"SRR3476821",
"SRR3476822",
"SRR3476823",
"SRR3476824",
"SRR3476825",
"SRR3476826",
"SRR3476827",
"SRR3476828",
"SRR3476829",
"SRR3476833",
"SRR3476835",
"SRR3476836",
"SRR3476837",
"SRR3476838",
"SRR3476839",
"SRR3476840",
"SRR3476841",
"SRR3476842",
"SRR3476843",
"SRR3476844",
"SRR3476845",
"SRR3476847",
"SRR3476848",
"SRR3476849",
"SRR4419674",
"SRR4419679")) %>% View()



#for i in LT2_HC2_1852_*/snps.tab; do awk '{print FILENAME"\t"$0}' $i > ${i/.tab/}_named.tab; done
#for f in LT2_HC2*; do mv ${f}/snps_named.tab combined_snps/${f}_snps.tab; done
#cat combined_snps/*_snps.tab > concatenated_snps.tab

concatenated_snps <- read_delim("analysis/pairwise_snps/concatenated_snps.tab", 
                                delim = "\t", escape_double = FALSE, 
                                trim_ws = TRUE)

concatenated_snps <- concatenated_snps %>% filter(CHROM != "CHROM")


concatenated_snps %>% 
